- name: Deploy ServerLedge
  hosts: all
  user: giacomo

  tasks:
      - name: Create the target directory if it doesn't exist
        file:
          path: ~/serverledge-deploy
          state: directory
          mode: '0755'
      - name: Update the local git repository
        git:
            repo: https://github.com/grussorusso/serverledge-deploy.git
            dest: ~/serverledge-deploy
            version: pmc23
            clone: yes
      - name: Copy the local file to the remote directory
        copy:
            src: ../../bin/serverledge
            dest: ~/serverledge-deploy/
            mode: '0777'